---
title: "Zi-Frühindikatoren zu COVID-19"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: scroll 
    logo: static/logo.png
    theme: bootstrap
    css: static/styles.css
    
    
---

```{r setup, include=FALSE}
library(flexdashboard)
source("R/functions.R", encoding = "UTF-8")
```

# Dashboard 

Row {data-height=125}
------------------------------------------------------------------------

### **Zi-Frühindikatoren:** 

Das Zi hat Frühindikatoren entwickelt, die frühzeitig auf die Gefahr für die Überlastung des Gesundheitswesens durch COVID-19 hinweisen sollen. Nachfolgend wird unsere tägliche Lageeinschätzung im Hinblick auf diese Indikatoren dargestellt. **Nähere Informationen finden Sie [hier](https://www.zi.de/presse/presseinformationen/5-mai-2020-2/)**. 

Stand: `r format(now(),format="%d.%m.%Y %H.%M Uhr")`

Row 
------------------------------------------------------------------------

### Reproduktionszahl 

```{r}
indicatorR <- aktuell %>% filter(id==0) %>% collect() %>% pull(R0)
valueBox(value= paste("R =",format(indicatorR,digits=2,decimal.mark = ","))  ,
         caption="Reproduktionszahl",
         color = case_when(indicatorR < 1.0 ~ "#B1C800",
                           indicatorR >= 1.0 & 
                             indicatorR < 1.3 ~ "#E49900",
                           indicatorR >= 1.3 ~ "#E40000"),
         icon = "fa-users"
        )
```

Row 
------------------------------------------------------------------------
### Neue Fälle pro Tag (7-Tages-Mittelwert) 

```{r}
faelleprotag <-  vorwarnzeitergebnis %>% filter(id==0) %>% pull(Faelle_letzte_7_Tage_pro_Tag)
gesundheitsamtzahl <- 380
valueBox(faelleprotag,
         caption="Neue Fälle pro Tag (7-Tages-Durchschnitt)",
         icon = "fa-chart-line",
         color = case_when(faelleprotag < gesundheitsamtzahl*3 ~ "#B1C800",
                           faelleprotag >= gesundheitsamtzahl*3 & 
                             faelleprotag < gesundheitsamtzahl*4 ~ "#E49900",
                           faelleprotag >= gesundheitsamtzahl*4 ~ "#E40000")
        )
```

Row 
------------------------------------------------------------------------
### Vorwarnzeit bei R=1,3 

```{r}
vorwarnzeitaktuell <-vorwarnzeitergebnis %>% filter(id==0) %>% pull(Vorwarnzeit_effektiv)
valueBox(paste(vorwarnzeitaktuell,"Tage"),
         caption="Effektive Vorwarnzeit bei R=1,3",
         icon = "fa-calendar-alt",
         color = case_when(vorwarnzeitaktuell > 60 ~ "#B1C800",
                           vorwarnzeitaktuell <= 60 & 
                             vorwarnzeitaktuell > 14 ~ "#E49900",
                           vorwarnzeitaktuell < 14 ~ "#E40000")
        )
```

Row {data-height=125}
------------------------------------------------------------------------
\
**Legende:** \
*Reproduktionszahl R*: Anzahl der Personen, die eine infizierte Person durchschnittlich mit COVID-19 infiziert. \
*Neue Fälle pro Tag (7-Tages-Durchschnitt)*: Durschnittliche Anzahl neuer Fälle pro Tag in den letzten 7 Meldetagen.\
*Effektive Vorwarnzeit bei R=1,3*: Anzahl von Tagen bis zur Überschreitung der stationären Behandlungskapazitäten ab heute, falls R=1,3 ab dem `r format(now(),format="%d.%m.%Y")`.

Row {data-height=170}
------------------------------------------------------------------------
\
**Methodischer Hinweis zum R-Wert:** \
*In die Berechnung des R-Wertes gehen verschiedene Annahmen ein, da der Wert aufgrund unvollständiger Informationen zu Infektionsketten in der Regel geschätzt werden muss. Die Methodik des Zi und des RKI unterscheiden sich dabei zwei zentralen Punkten. Das RKI betrachtet die neuen Erkrankten nach Erkrankungsdatum im Vergleich von zwei 4-Tages-Perioden und nimmt dadurch eine 4-tägige-Ansteckungsperiode an. Dabei müssen für etwa ein Drittel der Infizierten das Erkrankungsdatum geschätzt und Nachmeldungen durch das sog. Nowcasting interpoliert werden. Das Zi verwendet das Meldedatum als Infektionsbeginn und berücksichtigt eine längere Infektionsperiode, in der die meisten Ereignisse am 4. Tag auftreten, Ansteckungen aber auch später auftreten können (Gamma Verteilung mit MW=4, SD=5). Beide Ansätze haben Vor- und Nachteile und zeigen langfristig die gleiche Tendenz an.*

Row {data-height=400}
------------------------------------------------------------------------

### **Aktuelle Vorwarnzeiten**

```{r}
ggplotly(plot_Anstiegtheor  + theme(legend.position='none')+labs(x="R(t)")) %>%
   config(displayModeBar = FALSE, responsive=T,staticPlot=T)
```

Row {data-height=100}
------------------------------------------------------------------------

Dargestellt ist die theoretische Vorwarnzeit bis zur Überschreitung der Kapazität an Intensivbetten abhängig von der Reproduktionszahl R, ausgehend von der durchschnittlichen aktuellen Zahl an Neuinfektionen in Deutschland. Die Neuinfektionen wurden über einen Zeitraum von 7 Tagen gemittelt, um Schwankungen auszugleichen. Die effektive Vorwarnzeit ist geringer als die theoretische Vorwarnzeit. Hier wird eine Reaktionszeit von 21 Tagen angenommen, bis ein R-Wert erkannt und Maßmahmen wirksam implementiert sind.



Row {data-height=400}
------------------------------------------------------------------------
### **Entwicklung der akut Infizierten**

```{r}

ggplotly(akutinfiziert + labs(title="")) %>%
   config(displayModeBar = FALSE, responsive=T,staticPlot=T)
```

Row {data-height=100}
------------------------------------------------------------------------

Dargestellt ist die Entwicklung der Anzahl von akut infizierten Personen in Deutschland. Angenommen wird, dass die Personen i.d.R. 15 Tage nach der gemeldeten Erkrankung nicht mehr akut infiziert sind. Die Zahl hat am 6.4.2020 ihren bisherigen Höhepunkt von ca. 74 Tsd. Personen gehabt. 


Row {data-height=400}
------------------------------------------------------------------------
### **Entwicklung der Reproduktionszahl**

```{r}
mitigationsplot_blvergleich() %>%
   config(displayModeBar = FALSE, responsive=T,staticPlot=T)

```

Row {data-height=100}
------------------------------------------------------------------------

Dargestellt ist die Entwicklung der Reproduktionszahl R auf Ebene der Bundesländer. Der Wert für den Bund ist blau dargestellt. R beschreibt die mittlere Anzahl von Neu-Infektionen, die von einer Person im Laufe ihrer COVID-19-Infektion angesteckt werden. R wird aus den Meldedaten des RKI geschätzt.


Row
-----------------------------------------------------------------------

### **Überblick zu den Kennzahlen der Bundesländer**

```{r}
DT::datatable(rki_fallzahl_bl(),
              extensions = 'Responsive',
              options = list(paging = FALSE,
                             searching = FALSE,
                             language = list(url = '//cdn.datatables.net/plug-ins/1.10.11/i18n/German.json'),
                             server = FALSE,
                             initComplete = JS("function(settings, json) {","$(this.api().table().header()).css({'background-color':'#0086C5','color': '#fff'});","}")))

```

# Kreise

Row {data-height=100}
-----------------------------------------------------------------------

### **Überblick zu den Kennzahlen der Kreise**

Nachfolgend erhalten Sie einen Überblick zur Situation der einzelnen Kreise. Bitte beachten Sie, dass der Indikator Vorwarnzeit auf Ebene der Kreise und Städte nicht losgelöst von der Situation im jeweiligen Bundesland betrachtet werden sollte. Sofern die lokale Vorwarnzeit sehr gering ist, die Vorwarnzeit im Bundesland zugehörigen Bundesland aber vergleichsweise hoch ist, besteht unseres Erachtens noch keine kritische Situation.

Row
-----------------------------------------------------------------------


```{r}
DT::datatable(rki_fallzahl_kreis(),
              extensions = 'Responsive',
              options = list(paging = TRUE,
                             searching = TRUE,
                             language = list(url = '//cdn.datatables.net/plug-ins/1.10.11/i18n/German.json'),
                             server = FALSE,
                             initComplete = JS("function(settings, json) {","$(this.api().table().header()).css({'background-color':'#0086C5','color': '#fff'});","}")))

```


# Impressum

```{r include=FALSE}
# Datenexport Vorbereitung

frueindikatoren <- bind_cols("Indikator"=c("R-Wert",
                                           "Neue Fälle pro Tag",
                                           "Vorwarnzeit aktuell in Tagen"),
                             "Wert"=c(indicatorR,
                                      faelleprotag,
                                      vorwarnzeitaktuell))

write_json(frueindikatoren,"data/frueindikatoren.json")
#write_json(rki_fallzahl_bl(),"data/bundeslaender.json")
#write_json(theoretisch,"data/vorwarnzeiten.json")
```


**Zentralinstitut für die kassenärztliche Versorgung in der Bundesrepublik Deutschland (Stiftung des bürgerlichen Rechts)**

Salzufer 8  
10587 Berlin  
Telefon: (030) 4005-2450  
Fax: (030) 4005-2490

E-Mail: [zi(at)zi.de](mailto:zi(at)zi.de)  
Internet: [www.zi.de](http://www.zi.de)

**Vertretung der Stiftung:**

Die Stiftung wird gerichtlich und außergerichtlich durch den Vorstand vertreten. Der Vorstand handelt durch seinen Vorsitzenden allein. Im Falle der Verhinderung des Vorsitzenden wird die Stiftung durch den Stellvertretenden Vorstandsvorsitzenden allein vertreten.

**Vorstandsvorsitzender:**

Dr. Dominik von Stillfried  

**Stellvertretender Vorstandsvorsitzender:**

Thomas Czihal

**Verantwortlicher für redaktionelle Inhalte:**

Dr. Dominik Graf von Stillfried

*USt-IdNr.: DE239451993*
  
Der Nutzung von im Rahmen der Impressumspflicht veröffentlichten Kontaktdaten durch Dritte zur Übersendung von nicht ausdrücklich angeforderter Werbung und Informationsmaterialien wird hiermit ausdrücklich widersprochen.

